 (cd "$(git rev-parse --show-toplevel)" && git apply --3way <<'EOF' 
diff --git a/index.html b/index.html
index 7566294cb1187e7ce3113731db5e9cccfdf27ae9..f122796d139bcefbc342ad3a8572265e5c1eab7e 100644
--- a/index.html
+++ b/index.html
@@ -348,108 +348,123 @@ body{font-family:'Pretendard',sans-serif;background:var(--bg);color:var(--tx);mi
   </div>
 
   <!-- 메모 -->
   <div class="view-pane" id="pane-memo">
     <div class="view-toggle">
       <button class="vt-btn on" onclick="setSubView('memo','edit')">입력</button>
       <button class="vt-btn" onclick="setSubView('memo','list')">목록</button>
       <div class="vt-sp"></div>
       <button class="new-btn" onclick="newMemo()">+ 새 메모</button>
       <button class="new-btn" onclick="saveMemo()">저장</button>
     </div>
     <div class="sub-edit" data-g="memo">
       <div class="ed-hdr"><input class="ed-title" id="memo-title" placeholder="메모 제목"><div class="ed-meta"><span class="ed-date" id="memo-date"></span></div></div>
       <div class="ed-wrap"><textarea class="ed-body" id="memo-body" placeholder="메모를 작성하세요..."></textarea></div>
     </div>
     <div class="sub-list" data-g="memo" style="display:none"><div class="list-view" id="memo-list"></div></div>
   </div>
 </div>
 </div>
 
 <script>
 const K={docs:'gb_docs',checks:'gb_chk',books:'gb_books',quotes:'gb_quotes',memos:'gb_memos'};
 const L=k=>{try{return JSON.parse(localStorage.getItem(k))||null}catch{return null}};
 const S=(k,v)=>localStorage.setItem(k,JSON.stringify(v));
 
-const today=()=>new Date().toISOString().slice(0,10);
+const E=s=>String(s??'').replace(/[&<>"']/g,ch=>({
+  '&':'&amp;',
+  '<':'&lt;',
+  '>':'&gt;',
+  '"':'&quot;',
+  "'":'&#39;'
+}[ch]));
+
+const dateKey=(d)=>`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;
+const today=()=>dateKey(new Date());
 const weekdays=['일','월','화','수','목','금','토'];
 const fmtDate=iso=>{const d=new Date(iso);return`${d.getFullYear()}.${String(d.getMonth()+1).padStart(2,'0')}.${String(d.getDate()).padStart(2,'0')} (${weekdays[d.getDay()]})`};
 
 function getWeekDates(){
   const d=new Date();const day=d.getDay();
   // 일요일 시작: 일(0)~토(6)
   const sun=new Date(d);sun.setDate(d.getDate()-day);
-  return Array.from({length:7},(_,i)=>{const x=new Date(sun);x.setDate(sun.getDate()+i);return x.toISOString().slice(0,10)});
+  return Array.from({length:7},(_,i)=>{const x=new Date(sun);x.setDate(sun.getDate()+i);return dateKey(x)});
 }
 const isThisWeek=iso=>getWeekDates().includes(iso?.slice(0,10));
 
 document.getElementById('sideDate').textContent=fmtDate(new Date().toISOString());
 
 // ═══ Daily Checks ═══
 const CHECKS=[
   {id:'exercise',label:'운동'},
   {id:'vitamin',label:'영양제'},
   {id:'english',label:'영어'},
   {id:'japanese',label:'일본어'},
   {id:'drawing',label:'드로잉'},
   {id:'ukulele',label:'우쿨렐레'},
   {id:'nodrink',label:'금주'},
 ];
 
 function getChk(){const d=L(K.checks)||{};return d[today()]||{}}
 function saveChk(id,v){const d=L(K.checks)||{};if(!d[today()])d[today()]={};d[today()][id]=v;S(K.checks,d)}
 function getAllChk(){return L(K.checks)||{}}
 
 function renderChk(){
   const chk=getChk();
   const allChk=getAllChk();
   const week=getWeekDates();
   const todayS=today();
   const dayLabels=['일','월','화','수','목','금','토'];
 
   let html=`<div class="chk-week-hdr"><div class="chk-lb-space"></div><div class="day-labels">`;
   dayLabels.forEach(d=>{html+=`<div class="day-lbl">${d}</div>`});
   html+=`</div></div>`;
 
   CHECKS.forEach(c=>{
     const checked=chk[c.id];
     html+=`<div class="chk-row ${checked?'on':''}" onclick="toggleChk('${c.id}')">
       <div class="chk-box"><svg viewBox="0 0 16 16"><polyline points="3,8 7,12 13,4"/></svg></div>
       <span class="chk-lb">${c.label}</span>
       <div class="chk-dots">`;
     week.forEach(dt=>{
       const done=allChk[dt]&&allChk[dt][c.id];
       html+=`<div class="chk-dot ${done?'done':''} ${dt===todayS?'today':''}"></div>`;
     });
     html+=`</div></div>`;
   });
 
   document.getElementById('chkTable').innerHTML=html;
 }
 
 var _chkTimer=null;
-function toggleChk(id){const chk=getChk();saveChk(id,!chk[id]);renderChk();clearTimeout(_chkTimer);_chkTimer=setTimeout(()=>SYNC.saveChecksToSheet(),10000)}
+function toggleChk(id){
+  const chk=getChk();
+  saveChk(id,!chk[id]);
+  renderChk();
+  clearTimeout(_chkTimer);
+  _chkTimer=setTimeout(()=>SYNC.scheduleChecksSave(),1200);
+}
 
 // ═══ Documents ═══
 function allDocs(){return L(K.docs)||[]}
 function getDocs(type){return allDocs().filter(d=>d.type===type)}
 function saveDocs(docs){S(K.docs,docs)}
 const curIds={};
 
 function newDoc(type){
   const doc={id:Date.now().toString(),type,title:'',content:'',created:new Date().toISOString(),updated:new Date().toISOString()};
   const docs=allDocs();docs.unshift(doc);saveDocs(docs);
   loadDoc(type,doc.id);setSubView(type,'edit');
 }
 
 function loadDoc(type,id){
   const doc=allDocs().find(d=>d.id===id);if(!doc)return;
   curIds[type]=id;
   document.getElementById(`${type}-title`).value=doc.title;
   document.getElementById(`${type}-body`).value=doc.content;
   document.getElementById(`${type}-date`).textContent=fmtDate(doc.created);
   updateWC(type);setSubView(type,'edit');
 }
 
 function saveCurDoc(type){
   if(!curIds[type])return;
   const docs=allDocs();const idx=docs.findIndex(d=>d.id===curIds[type]);if(idx===-1)return;
@@ -459,142 +474,144 @@ function saveCurDoc(type){
   saveDocs(docs);
   const el=document.getElementById(`${type}-save`);if(el)el.textContent='저장됨';
   updateWritingStats();
 }
 
 function delDoc(type,id,e){
   e.stopPropagation();if(!confirm('삭제할까요?'))return;
   let docs=allDocs().filter(d=>d.id!==id);saveDocs(docs);
   if(curIds[type]===id){const rem=docs.filter(d=>d.type===type);if(rem.length)loadDoc(type,rem[0].id);else newDoc(type);}
   renderList(type);updateWritingStats();
 }
 
 function countS(t){const c=t.replace(/\s/g,'').length;const w=t.trim()?t.trim().split(/\s+/).length:0;return{c,w,p:(c/200).toFixed(1)}}
 function updateWC(type){
   const t=document.getElementById(`${type}-body`).value;const{c,w,p}=countS(t);
   const ce=document.getElementById(`${type}-chars`),we=document.getElementById(`${type}-words`),pe=document.getElementById(`${type}-pages`);
   if(ce){ce.textContent=c.toLocaleString()+'자';we.textContent=w.toLocaleString()+'단어';pe.textContent=p+'매'}
 }
 
 function renderList(type){
   const docs=getDocs(type);
   const colors={navi:'var(--tab-navi)',fiction:'var(--tab-500)',blog:'var(--tab-blog)'};
   const el=document.getElementById(`${type}-list`);if(!el)return;
   if(!docs.length){el.innerHTML='<div style="text-align:center;padding:50px;color:var(--tx-m)">아직 글이 없습니다</div>';return}
   el.innerHTML=docs.map(d=>{
-    const{c}=countS(d.content);const prev=d.content.replace(/\n/g,' ').slice(0,80);
+    const{c}=countS(d.content);const prev=E(d.content.replace(/\n/g,' ').slice(0,80));
     return`<div class="list-item" onclick="loadDoc('${type}','${d.id}')">
       <div class="list-tag" style="background:${colors[type]}"></div>
-      <div class="list-info"><div class="list-title">${d.title||'제목 없음'}</div><div class="list-date">${fmtDate(d.created)}</div>${prev?`<div class="list-preview">${prev}</div>`:''}</div>
+      <div class="list-info"><div class="list-title">${E(d.title||'제목 없음')}</div><div class="list-date">${fmtDate(d.created)}</div>${prev?`<div class="list-preview">${prev}</div>`:''}</div>
       <span class="list-extra">${c.toLocaleString()}자</span>
       <button class="list-del" onclick="delDoc('${type}','${d.id}',event)">✕</button></div>`}).join('');
 }
 
 // ═══ Books ═══
 let curBookId=null;
 function getBooks(){return L(K.books)||[]}
 function saveBooks(b){S(K.books,b)}
 
 function newBook(){
   curBookId=null;
   ['book-title','book-author','book-publisher','book-pages','book-body'].forEach(id=>document.getElementById(id).value='');
   setSubView('book','edit');
 }
 
 function saveBook(){
   const title=document.getElementById('book-title').value.trim();
   if(!title){alert('책 제목을 입력해주세요');return}
   const books=getBooks();
   const data={title,author:document.getElementById('book-author').value.trim(),publisher:document.getElementById('book-publisher').value.trim(),pages:parseInt(document.getElementById('book-pages').value)||0,memo:document.getElementById('book-body').value,date:today(),updated:new Date().toISOString()};
   if(curBookId){const idx=books.findIndex(b=>b.id===curBookId);if(idx!==-1)Object.assign(books[idx],data)}
   else{data.id=Date.now().toString();data.created=new Date().toISOString();books.unshift(data);curBookId=data.id}
   saveBooks(books);renderBookList();renderBookMini();setSubView('book','list');SYNC.saveBooksToSheet(data);
 }
 
 function loadBook(id){
   const b=getBooks().find(x=>x.id===id);if(!b)return;curBookId=id;
   document.getElementById('book-title').value=b.title;
   document.getElementById('book-author').value=b.author||'';
   document.getElementById('book-publisher').value=b.publisher||'';
   document.getElementById('book-pages').value=b.pages||'';
   document.getElementById('book-body').value=b.memo||'';
   setSubView('book','edit');
 }
 
 function delBook(id,e){
   e.stopPropagation();if(!confirm('삭제할까요?'))return;
   saveBooks(getBooks().filter(b=>b.id!==id));renderBookList();renderBookMini();
 }
 
 function renderBookList(){
   const books=getBooks();const el=document.getElementById('book-list');
   if(!books.length){el.innerHTML='<div style="text-align:center;padding:50px;color:var(--tx-m)">등록된 책이 없습니다</div>';return}
-  el.innerHTML=books.map(b=>`
-    <div class="list-item" onclick="loadBook('${b.id}')">
+  el.innerHTML=books.map(b=>{
+    const preview=E((b.memo||'').replace(/\n/g,' ').slice(0,60));
+    return `<div class="list-item" onclick="loadBook('${b.id}')">
       <div class="list-tag" style="background:var(--tab-book)"></div>
-      <div class="list-info"><div class="list-title">${b.title}</div><div class="list-date">${b.author||''}${b.publisher?' · '+b.publisher:''}</div>${b.memo?`<div class="list-preview">${b.memo.replace(/\n/g,' ').slice(0,60)}</div>`:''}</div>
+      <div class="list-info"><div class="list-title">${E(b.title)}</div><div class="list-date">${E((b.author||'')+(b.publisher?' · '+b.publisher:''))}</div>${preview?`<div class="list-preview">${preview}</div>`:''}</div>
       <span class="list-extra">${b.pages?b.pages+'p':''}</span>
-      <button class="list-del" onclick="delBook('${b.id}',event)">✕</button></div>`).join('');
+      <button class="list-del" onclick="delBook('${b.id}',event)">✕</button></div>`;
+  }).join('');
 }
 
 function renderBookMini(){
   const books=getBooks().filter(b=>b.date&&(b.date===today()||isThisWeek(b.date))).slice(0,3);
   const el=document.getElementById('bookMiniList');
   if(!books.length){el.innerHTML='<div style="font-size:11px;color:var(--tx-m)">이번 주 기록 없음</div>';return}
-  el.innerHTML=books.map(b=>`<div class="book-mini"><span class="book-mini-t">${b.title}</span><span class="book-mini-p">${b.pages?b.pages+'p':''}</span></div>`).join('');
+  el.innerHTML=books.map(b=>`<div class="book-mini"><span class="book-mini-t">${E(b.title)}</span><span class="book-mini-p">${b.pages?b.pages+'p':''}</span></div>`).join('');
 }
 
 // ═══ Quotes ═══
 function getQuotes(){return L(K.quotes)||[]}
 function saveQuotes(q){S(K.quotes,q)}
 
 function saveQuote(){
   const text=document.getElementById('quote-body').value.trim();if(!text)return;
   const by=document.getElementById('quote-by').value.trim();
   const quotes=getQuotes();quotes.unshift({id:Date.now().toString(),text,by,created:new Date().toISOString()});
   saveQuotes(quotes);
   newQuote();renderQuoteList();showRandomQuote();SYNC.saveQuotesToSheet(text, by);
 }
 
 function newQuote(){
   document.getElementById('quote-body').value='';
   document.getElementById('quote-by').value='';
   setSubView('quote','edit');
 }
 
 function delQuote(id,e){
   e.stopPropagation();if(!confirm('삭제할까요?'))return;
   saveQuotes(getQuotes().filter(q=>q.id!==id));renderQuoteList();showRandomQuote();
 }
 
 function renderQuoteList(){
   const quotes=getQuotes();const el=document.getElementById('quote-list');
   if(!quotes.length){el.innerHTML='<div style="text-align:center;padding:50px;color:var(--tx-m)">어구록이 비어있습니다</div>';return}
   el.innerHTML=quotes.map(q=>`
     <div class="list-item" style="align-items:flex-start">
       <div class="list-tag" style="background:var(--tab-quote);min-height:20px"></div>
-      <div class="list-info"><div class="list-preview" style="white-space:normal;font-size:13px;color:var(--tx);font-family:'Noto Serif KR',serif;line-height:1.7">${q.text.slice(0,120)}${q.text.length>120?'...':''}</div>${q.by?`<div class="list-date" style="margin-top:4px">${q.by}</div>`:''}</div>
+      <div class="list-info"><div class="list-preview" style="white-space:normal;font-size:13px;color:var(--tx);font-family:'Noto Serif KR',serif;line-height:1.7">${E(q.text.slice(0,120))}${q.text.length>120?'...':''}</div>${q.by?`<div class="list-date" style="margin-top:4px">${E(q.by)}</div>`:''}</div>
       <button class="list-del" onclick="delQuote('${q.id}',event)">✕</button></div>`).join('');
 }
 
 function showRandomQuote(){
   const quotes=getQuotes();
   if(!quotes.length){document.getElementById('rqText').textContent='어구록에 문장을 추가해보세요';document.getElementById('rqText').style.color='var(--tx-m)';document.getElementById('rqText').style.fontSize='12px';document.getElementById('rqBy').textContent='';return}
   const q=quotes[Math.floor(Math.random()*quotes.length)];
   document.getElementById('rqText').textContent=q.text.length>100?q.text.slice(0,100)+'…':q.text;
   document.getElementById('rqText').style.color='var(--tx)';document.getElementById('rqText').style.fontSize='13px';
   document.getElementById('rqBy').textContent=q.by?'— '+q.by:'';
 }
 
 // ═══ Writing Stats ═══
 function updateWritingStats(){
   const docs=allDocs().filter(d=>d.type==='fiction');
   const todayS=today();const weekDates=getWeekDates();
   let tToday=0,tWeek=0,tTotal=0;
   docs.forEach(d=>{
     const chars=d.content.replace(/\s/g,'').length;
     const dt=d.updated?.slice(0,10)||d.created?.slice(0,10);
     tTotal+=chars;
     if(dt===todayS)tToday+=chars;
     if(weekDates.includes(dt))tWeek+=chars;
   });
   // 현재 편집 중인 fiction 에디터 내용도 반영
@@ -667,198 +684,244 @@ function saveMemo(){
     const memo={id:Date.now().toString(),title,content:body,created:new Date().toISOString(),updated:new Date().toISOString()};
     memos.unshift(memo);curMemoId=memo.id;
   }
   saveMemos(memos);renderMemoList();setSubView('memo','list');SYNC.saveMemosToSheet({title, content:body});
 }
 
 function loadMemo(id){
   const m=getMemos().find(x=>x.id===id);if(!m)return;curMemoId=id;
   document.getElementById('memo-title').value=m.title||'';
   document.getElementById('memo-body').value=m.content||'';
   document.getElementById('memo-date').textContent=fmtDate(m.created);
   setSubView('memo','edit');
 }
 
 function delMemo(id,e){
   e.stopPropagation();if(!confirm('삭제할까요?'))return;
   saveMemos(getMemos().filter(m=>m.id!==id));renderMemoList();
 }
 
 function renderMemoList(){
   const memos=getMemos();const el=document.getElementById('memo-list');
   if(!memos.length){el.innerHTML='<div style="text-align:center;padding:50px;color:var(--tx-m)">메모가 없습니다</div>';return}
   el.innerHTML=memos.map(m=>`
     <div class="list-item" onclick="loadMemo('${m.id}')">
       <div class="list-tag" style="background:#a09080"></div>
-      <div class="list-info"><div class="list-title">${m.title||'제목 없음'}</div><div class="list-date">${fmtDate(m.created)}</div>${m.content?`<div class="list-preview">${m.content.replace(/\n/g,' ').slice(0,60)}</div>`:''}</div>
+      <div class="list-info"><div class="list-title">${E(m.title||'제목 없음')}</div><div class="list-date">${fmtDate(m.created)}</div>${m.content?`<div class="list-preview">${E(m.content.replace(/\n/g,' ').slice(0,60))}</div>`:''}</div>
       <button class="list-del" onclick="delMemo('${m.id}',event)">✕</button></div>`).join('');
 }
 
 // ═══ Google Apps Script 연동 ═══
 const GAS_URL = 'https://script.google.com/macros/s/AKfycbysOb_XZi1k1FkhGhki9XqKraC-I5YMvpdSIBpcfUxDXtq7J9Nd-JcodVk5fM_78z4/exec';
 
 const SYNC = {
   timer: null,
   queue: [], // 저장 대기열
   saving: false,
+  checksTimer: null,
+  checksSaving: false,
+  checksPending: false,
+  lastChecksPayload: '',
+  lastChecksRequestKey: '',
 
   setSyncStatus(text, type) {
     const el = document.getElementById('syncStatus');
     if (el) { el.textContent = text; el.className = 'sync-status ' + (type || ''); }
   },
 
   // 글(navi, fiction, blog)을 구글 문서로 저장
   async saveDocToGDrive(type, title, content) {
     if (!GAS_URL || !content.trim()) return;
     const fileName = title || today();
 
     try {
       this.setSyncStatus('동기화 중...', 'syncing');
       await this._post({
         action: 'save_doc',
         type: type,
         title: fileName,
         content: content
       });
       this.setSyncStatus('Drive 저장 완료', 'ok');
       setTimeout(() => this.setSyncStatus('Google Drive 연결됨', 'ok'), 2000);
     } catch (e) {
       console.error('GAS save error:', e);
       this.setSyncStatus('저장 실패', 'error');
     }
   },
 
-  // 루틴 체크를 구글 시트에 저장
+  // 루틴 체크를 구글 시트에 저장 (디바운스 + 직렬화)
+  scheduleChecksSave() {
+    clearTimeout(this.checksTimer);
+    this.checksTimer = setTimeout(() => this.saveChecksToSheet(), 400);
+  },
+
   async saveChecksToSheet() {
     if (!GAS_URL) return;
+
+    const checks = getChk();
+    const payload = {
+      action: 'save_routine',
+      date: today(),
+      checks: checks
+    };
+    const payloadKey = JSON.stringify(payload);
+    const requestKey = `routine:${payload.date}:${btoa(unescape(encodeURIComponent(payloadKey))).slice(0,32)}`;
+
+    if (this.checksSaving) {
+      this.checksPending = true;
+      return;
+    }
+
+    if (payloadKey === this.lastChecksPayload) return;
+
+    this.checksSaving = true;
     try {
-      await this._post({
-        action: 'save_routine',
-        date: today(),
-        checks: getChk()
-      });
+      payload.requestKey = requestKey;
+      await this._post(payload);
+      this.lastChecksPayload = payloadKey;
+      this.lastChecksRequestKey = requestKey;
     } catch (e) {
       console.error('GAS checks error:', e);
+    } finally {
+      this.checksSaving = false;
+      if (this.checksPending) {
+        this.checksPending = false;
+        this.scheduleChecksSave();
+      }
     }
   },
 
   // 어구록을 구글 시트에 저장 (최신 1개)
   async saveQuotesToSheet(text, by) {
     if (!GAS_URL) return;
     try {
       await this._post({
         action: 'save_quote',
         text: text || '',
         by: by || ''
       });
     } catch (e) {
       console.error('GAS quotes error:', e);
     }
   },
 
   // 서재를 구글 문서로 저장
   async saveBooksToSheet(book) {
     if (!GAS_URL || !book) return;
     try {
       await this._post({
         action: 'save_doc',
         type: 'book',
         title: book.title,
         content: `저자: ${book.author||''}\n출판사: ${book.publisher||''}\n읽은 양: ${book.pages||0}p\n\n${book.memo||''}`
       });
     } catch (e) {
       console.error('GAS books error:', e);
     }
   },
 
   // 메모를 구글 문서로 저장
   async saveMemosToSheet(memo) {
     if (!GAS_URL || !memo) return;
     try {
       await this._post({
         action: 'save_doc',
         type: 'memo',
         title: memo.title || '메모',
         content: memo.content || ''
       });
     } catch (e) {
       console.error('GAS memos error:', e);
     }
   },
 
   // Apps Script 웹앱에 POST 전송 (공통)
+  // no-cors로 전송 성공/실패만 판단해 CORS/리다이렉트 파싱 문제로 인한 중복 재시도를 줄인다.
   async _post(data) {
-    const resp = await fetch(GAS_URL, {
+    await fetch(GAS_URL, {
       method: 'POST',
-      redirect: 'follow',
+      mode: 'no-cors',
+      cache: 'no-store',
       headers: { 'Content-Type': 'text/plain;charset=utf-8' },
       body: JSON.stringify(data)
     });
-    // Apps Script는 리다이렉트 후 opaque response를 줄 수 있음
-    try { return await resp.json(); } catch { return { status: 'sent' }; }
+    return { status: 'sent' };
   },
 
   // 디바운스된 문서 저장
   scheduleDocSave(type) {
     clearTimeout(this.timer);
     this.timer = setTimeout(() => {
       if (!curIds[type]) return;
       const doc = allDocs().find(d => d.id === curIds[type]);
       if (doc && doc.content.trim()) {
         this.saveDocToGDrive(type, doc.title, doc.content);
       }
     }, 5000); // 5초 디바운스 (로컬 저장보다 느리게)
   },
 
   // 수동 전체 동기화 (글만 저장 — 루틴/어구록은 각각 저장 시 자동)
   async syncAll() {
     this.setSyncStatus('전체 동기화 중...', 'syncing');
     for (const type of ['navi', 'fiction', 'blog']) {
       if (curIds[type]) {
         const doc = allDocs().find(d => d.id === curIds[type]);
         if (doc && doc.content.trim()) {
           await this.saveDocToGDrive(type, doc.title, doc.content);
         }
       }
     }
     this.setSyncStatus('전체 동기화 완료', 'ok');
     setTimeout(() => this.setSyncStatus('Google Drive 연결됨', 'ok'), 2000);
   }
 };
 
 // ═══ Auto-save (로컬 + Drive 연동) ═══
 const timers={};
 function setupEditor(type){
   const body=document.getElementById(`${type}-body`);const title=document.getElementById(`${type}-title`);if(!body)return;
   const onInput=()=>{
     const sv=document.getElementById(`${type}-save`);if(sv)sv.textContent='저장 중...';
     clearTimeout(timers[type]);
     timers[type]=setTimeout(()=>{
       saveCurDoc(type);
       // 로컬 저장 후 Drive에도 저장
       if (['navi','fiction','blog'].includes(type)) SYNC.scheduleDocSave(type);
     },800);
     updateWC(type);
   };
   body.addEventListener('input',onInput);if(title)title.addEventListener('input',onInput);
 }
 
 // ═══ Init ═══
+
+function cleanupStrayTextNodes(){
+  // 배포/복붙 실수로 body 최상단에 텍스트가 섞인 경우 UI 깨짐 방지
+  const nodes=Array.from(document.body.childNodes);
+  nodes.forEach(n=>{
+    if(n.nodeType===Node.TEXT_NODE && n.textContent && n.textContent.trim()){
+      n.remove();
+    }
+  });
+}
+
 function init(){
+  cleanupStrayTextNodes();
   renderChk();renderBookMini();showRandomQuote();updateWritingStats();
   ['navi','fiction','blog'].forEach(type=>{
     setupEditor(type);const docs=getDocs(type);
     if(docs.length)loadDoc(type,docs[0].id);else newDoc(type);
   });
   document.addEventListener('keydown',e=>{if((e.ctrlKey||e.metaKey)&&e.key==='s'){e.preventDefault();['navi','fiction','blog'].forEach(t=>saveCurDoc(t))}});
 
   // GAS 연결 상태 확인
   if (GAS_URL) {
     SYNC.setSyncStatus('Google Drive 연결됨', 'ok');
   } else {
     SYNC.setSyncStatus('로컬 전용', '');
   }
 }
 init();
 </script>
 </body>
 </html>
 
EOF
)
