<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>이름표 붙이기 게임</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@400;600;700&family=Pretendard:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #f5f2ed;
  --bg-side: #edeae4;
  --bg-card: #e4e0d8;
  --bg-card-h: #dbd7cf;
  --bg-input: #f8f6f2;
  --bg-white: #faf9f6;
  --border: #d5d0c7;
  --border-l: #c5c0b5;
  --tx: #2c2922;
  --tx-d: #6b6358;
  --tx-m: #9a9488;
  --ac: #b08968;
  --ac-d: #8a6a48;
  --ac-light: #c9a882;
  --grn: #5a8a5a;
  --grn-bg: #e8f0e8;
  --grn-light: #d0e4d0;
  --red: #a06060;
  --blue: #5878a0;
  --tab-navi: #b08968;
  --tab-500: #5a8a5a;
  --tab-blog: #5878a0;
  --tab-book: #8a6898;
  --tab-quote: #8a8060;
  --r: 8px;
  --r-sm: 5px;
  --side-w: 340px;
  --shadow: 0 1px 3px rgba(0,0,0,.06);
}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Pretendard',sans-serif;background:var(--bg);color:var(--tx);height:100vh;overflow:hidden}
.app{display:flex;height:100vh}

/* ─── SIDEBAR ─── */
.side{width:var(--side-w);min-width:var(--side-w);background:var(--bg-side);border-right:1px solid var(--border);display:flex;flex-direction:column;overflow-y:auto}
.side-hdr{padding:22px 20px 16px;border-bottom:1px solid var(--border)}
.side-date{font-size:11px;color:var(--tx-m);letter-spacing:1px;font-family:'JetBrains Mono',monospace}
.side-brand{font-family:'Noto Serif KR',serif;font-size:18px;font-weight:700;margin-top:3px;color:var(--ac-d);display:flex;align-items:center;gap:8px}
.avatar{width:32px;height:32px;border-radius:50%;object-fit:cover;border:2px solid var(--ac-light);box-shadow:0 1px 4px rgba(0,0,0,.1)}

/* Section */
.sec{padding:14px 20px;border-bottom:1px solid var(--border)}
.sec-t{font-size:10px;font-weight:600;text-transform:uppercase;letter-spacing:1.5px;color:var(--tx-m);margin-bottom:10px}

/* Check items with inline week dots */
.chk-table{display:flex;flex-direction:column;gap:0}
.chk-week-hdr{display:flex;align-items:center;padding:0 0 4px;margin-bottom:4px;border-bottom:1px solid var(--border)}
.chk-week-hdr .chk-lb-space{flex:1;min-width:80px}
.chk-week-hdr .day-labels{display:flex;gap:2px}
.chk-week-hdr .day-lbl{width:16px;text-align:center;font-size:9px;color:var(--tx-m);font-family:'JetBrains Mono',monospace;font-weight:500}

.chk-row{display:flex;align-items:center;padding:5px 0;cursor:pointer;user-select:none;border-radius:var(--r-sm);transition:background .15s;margin:0 -6px;padding-left:6px;padding-right:6px}
.chk-row:hover{background:var(--bg-card)}
.chk-box{width:16px;height:16px;border:1.5px solid var(--border-l);border-radius:3px;display:flex;align-items:center;justify-content:center;flex-shrink:0;transition:.2s;margin-right:8px}
.chk-row.on .chk-box{background:var(--grn);border-color:var(--grn)}
.chk-box svg{width:10px;height:10px;stroke:white;stroke-width:3;fill:none;opacity:0;transition:.2s}
.chk-row.on .chk-box svg{opacity:1}
.chk-lb{font-size:12.5px;color:var(--tx);flex:1;min-width:56px}
.chk-row.on .chk-lb{color:var(--tx-d);text-decoration:line-through;text-decoration-color:var(--border-l)}
.chk-dots{display:flex;gap:2px}
.chk-dot{width:16px;height:16px;border-radius:3px;background:var(--bg-white);border:1px solid var(--border);transition:.15s;position:relative}
.chk-dot.done{background:var(--grn-light);border-color:var(--grn)}
.chk-dot.today{box-shadow:inset 0 0 0 1.5px var(--ac-light)}

/* Stats */
.stats{display:flex;flex-direction:column;gap:8px}
.st-card{background:var(--bg-white);border-radius:var(--r);padding:12px 14px;box-shadow:var(--shadow)}
.st-row{display:flex;justify-content:space-between;align-items:center}
.st-lb{font-size:12px;color:var(--tx-d)}
.st-sub{display:flex;gap:12px;margin-top:8px}
.st-sub span{font-size:11px;color:var(--tx-m);font-family:'JetBrains Mono',monospace}
.st-sub b{color:var(--ac-d)}
.st-bar{height:3px;background:var(--border);border-radius:2px;margin-top:8px;overflow:hidden}
.st-bar-f{height:100%;background:linear-gradient(90deg,var(--ac-light),var(--ac));border-radius:2px;transition:width .5s}

/* Book mini */
.book-mini{display:flex;justify-content:space-between;align-items:center;padding:4px 0;font-size:12px}
.book-mini-t{color:var(--tx-d);flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.book-mini-p{color:var(--ac);font-family:'JetBrains Mono',monospace;font-size:11px;margin-left:8px;white-space:nowrap}
.more-btn{font-size:11px;color:var(--tx-m);background:none;border:none;cursor:pointer;padding:4px 0;font-family:'Pretendard',sans-serif}
.more-btn:hover{color:var(--ac)}

/* Random quote */
.q-card{background:var(--bg-white);border-radius:var(--r);padding:14px 16px;border-left:3px solid var(--tab-quote);cursor:pointer;transition:.2s;min-height:56px;box-shadow:var(--shadow);display:flex;gap:12px;align-items:flex-start}
.q-avatar{width:36px;height:36px;border-radius:50%;object-fit:cover;flex-shrink:0;border:1.5px solid var(--border)}
.q-content{flex:1;min-width:0}
.q-card:hover{background:var(--bg-card)}
.q-text{font-family:'Noto Serif KR',serif;font-size:13px;line-height:1.8;color:var(--tx)}
.q-by{font-size:10px;color:var(--tx-m);margin-top:6px}
.q-hint{font-size:9px;color:var(--tx-m);text-align:center;margin-top:4px;opacity:.5}

/* ─── MAIN ─── */
.main{flex:1;display:flex;flex-direction:column;overflow:hidden;background:var(--bg-white)}

/* Tab bar */
.tabs{display:flex;align-items:center;padding:0 20px;border-bottom:1px solid var(--border);background:var(--bg-side);height:46px;gap:1px}
.tab{padding:0 14px;height:46px;display:flex;align-items:center;gap:6px;font-size:13px;font-weight:500;color:var(--tx-m);background:none;border:none;border-bottom:2px solid transparent;cursor:pointer;transition:.2s;font-family:'Pretendard',sans-serif;white-space:nowrap}
.tab:hover{color:var(--tx-d)}
.tab.on{color:var(--tx);border-bottom-color:var(--ac)}
.tab-dot{width:6px;height:6px;border-radius:50%}

/* Sub-view toggle */
.view-pane{display:none;flex:1;flex-direction:column;overflow:hidden}
.view-pane.on{display:flex}
.view-toggle{display:flex;gap:4px;padding:10px 36px;border-bottom:1px solid var(--border);background:var(--bg)}
.vt-btn{padding:5px 12px;font-size:11px;font-weight:500;color:var(--tx-m);background:none;border:1px solid var(--border);border-radius:var(--r-sm);cursor:pointer;font-family:'Pretendard',sans-serif;transition:.2s}
.vt-btn:hover{color:var(--tx-d);border-color:var(--border-l)}
.vt-btn.on{color:var(--tx);background:var(--bg-white);border-color:var(--border-l);box-shadow:var(--shadow)}
.vt-sp{flex:1}
.new-btn{padding:5px 12px;font-size:11px;font-weight:500;color:white;background:var(--ac);border:none;border-radius:var(--r-sm);cursor:pointer;font-family:'Pretendard',sans-serif}
.new-btn:hover{opacity:.85}

/* Editor */
.ed-hdr{padding:20px 36px 0}
.ed-title{width:100%;background:none;border:none;font-family:'Noto Serif KR',serif;font-size:24px;font-weight:700;color:var(--tx);outline:none}
.ed-title::placeholder{color:var(--border-l)}
.ed-meta{display:flex;align-items:center;gap:10px;margin-top:10px;padding-bottom:12px;border-bottom:1px solid var(--border)}
.ed-date{font-size:11px;color:var(--tx-m);font-family:'JetBrains Mono',monospace}
.ed-wrap{flex:1;overflow-y:auto;padding:20px 36px 36px}
.ed-body{width:100%;min-height:300px;background:none;border:none;font-family:'Noto Serif KR',serif;font-size:15px;line-height:2;color:var(--tx);outline:none;resize:none}
.ed-body::placeholder{color:var(--border-l)}
.ed-foot{padding:8px 36px;border-top:1px solid var(--border);background:var(--bg);display:flex;gap:16px;font-size:11px;font-family:'JetBrains Mono',monospace;color:var(--tx-m)}
.ed-foot span{color:var(--tx-d)}

/* By-line */
.by-row{display:flex;gap:8px;padding:0 36px;margin-top:-8px;margin-bottom:8px}
.by-input{flex:1;background:var(--bg);border:1px solid var(--border);border-radius:var(--r-sm);padding:6px 10px;font-size:12px;color:var(--tx);font-family:'Pretendard',sans-serif;outline:none}
.by-input::placeholder{color:var(--tx-m)}
.by-input:focus{border-color:var(--ac-light)}

/* Book form */
.book-form{padding:16px 36px;display:flex;flex-direction:column;gap:10px;border-bottom:1px solid var(--border);background:var(--bg)}
.bf-field{display:flex;flex-direction:column;gap:3px}
.bf-row{display:flex;gap:10px}
.bf-label{font-size:10px;font-weight:600;color:var(--tx-m);letter-spacing:.5px}
.bf-input{width:100%;background:var(--bg-white);border:1px solid var(--border);border-radius:var(--r-sm);padding:8px 10px;font-size:13px;color:var(--tx);font-family:'Pretendard',sans-serif;outline:none}
.bf-input::placeholder{color:var(--border-l)}
.bf-input:focus{border-color:var(--ac-light);box-shadow:0 0 0 2px rgba(176,137,104,.1)}

/* List view */
.list-view{flex:1;overflow-y:auto;padding:16px 36px;display:flex;flex-direction:column;gap:6px}
.list-item{display:flex;align-items:center;gap:10px;padding:12px 14px;background:var(--bg);border-radius:var(--r);cursor:pointer;transition:.15s;box-shadow:var(--shadow)}
.list-item:hover{background:var(--bg-card)}
.list-tag{width:3px;height:28px;border-radius:2px;flex-shrink:0}
.list-info{flex:1;min-width:0}
.list-title{font-size:13px;font-weight:500;color:var(--tx);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.list-date{font-size:10px;color:var(--tx-m);font-family:'JetBrains Mono',monospace;margin-top:1px}
.list-preview{font-size:11px;color:var(--tx-d);margin-top:3px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.list-extra{font-size:10px;color:var(--tx-m);font-family:'JetBrains Mono',monospace;white-space:nowrap}
.list-del{background:none;border:none;color:var(--tx-m);cursor:pointer;font-size:14px;opacity:0;transition:.2s;padding:2px 4px}
.list-item:hover .list-del{opacity:1}
.list-del:hover{color:var(--red)}

.save-btn{padding:7px 16px;font-size:12px;font-weight:500;color:white;background:var(--ac);border:none;border-radius:var(--r-sm);cursor:pointer;font-family:'Pretendard',sans-serif}
.save-btn:hover{opacity:.85}

/* Scrollbar */
::-webkit-scrollbar{width:5px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px}
::-webkit-scrollbar-thumb:hover{background:var(--border-l)}

@keyframes fadeIn{from{opacity:0;transform:translateY(4px)}to{opacity:1;transform:translateY(0)}}
.sec{animation:fadeIn .3s ease forwards}
</style>
</head>
<body>
<div class="app">

<!-- ═══ SIDEBAR ═══ -->
<div class="side">
  <div class="side-hdr">
    <div class="side-date" id="sideDate"></div>
    <div class="side-brand"><img class="avatar" src="data:image/jpeg;base64,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" alt="지오">이름표 붙이기 게임</div>
  </div>

  <div class="sec">
    <div class="sec-t">오늘의 어구</div>
    <div class="q-card" id="randQuote" onclick="showRandomQuote()"><img class="q-avatar" src="data:image/jpeg;base64,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" alt=""><div class="q-content">
      <div class="q-text" id="rqText" style="color:var(--tx-m);font-size:12px">어구록에 문장을 추가해보세요</div>
      <div class="q-by" id="rqBy"></div>
    </div></div>
    <div class="q-hint">클릭하면 다른 문장</div>
  </div>

  <div class="sec">
    <div class="sec-t">데일리 루틴</div>
    <div class="chk-table" id="chkTable"></div>
  </div>

  <div class="sec">
    <div class="sec-t">기록</div>
    <div class="stats">
      <div class="st-card">
        <div class="st-row"><span class="st-lb">글쓴 양 (500자 습작)</span></div>
        <div class="st-sub">
          <span>오늘 <b id="wToday">0</b>매</span>
          <span>주간 <b id="wWeek">0</b>매</span>
          <span>누적 <b id="wTotal">0</b>매</span>
        </div>
        <div class="st-bar"><div class="st-bar-f" id="wBar" style="width:0"></div></div>
      </div>
      <div class="st-card">
        <div class="st-row"><span class="st-lb">읽은 책</span><button class="more-btn" onclick="switchTab('book');setSubView('book','list')">더보기 →</button></div>
        <div id="bookMiniList" style="margin-top:4px"></div>
      </div>
    </div>
  </div>
</div>

<!-- ═══ MAIN ═══ -->
<div class="main">
  <div class="tabs">
    <button class="tab on" data-t="navi" onclick="switchTab('navi')"><span class="tab-dot" style="background:var(--tab-navi)"></span>오늘의 네비</button>
    <button class="tab" data-t="fiction" onclick="switchTab('fiction')"><span class="tab-dot" style="background:var(--tab-500)"></span>500자 습작</button>
    <button class="tab" data-t="blog" onclick="switchTab('blog')"><span class="tab-dot" style="background:var(--tab-blog)"></span>블로그</button>
    <button class="tab" data-t="book" onclick="switchTab('book')"><span class="tab-dot" style="background:var(--tab-book)"></span>서재</button>
    <button class="tab" data-t="quote" onclick="switchTab('quote')"><span class="tab-dot" style="background:var(--tab-quote)"></span>어구록</button>
    <button class="tab" data-t="memo" onclick="switchTab('memo')"><span class="tab-dot" style="background:#7a8a7a"></span>메모</button>
  </div>

  <!-- 오늘의 네비 -->
  <div class="view-pane on" id="pane-navi">
    <div class="view-toggle">
      <button class="vt-btn on" onclick="setSubView('navi','edit')">에디터</button>
      <button class="vt-btn" onclick="setSubView('navi','list')">목록</button>
      <div class="vt-sp"></div>
      <button class="new-btn" onclick="newDoc('navi')">+ 새 글</button>
    </div>
    <div class="sub-edit" data-g="navi">
      <div class="ed-hdr"><input class="ed-title" id="navi-title" placeholder="오늘의 네비"><div class="ed-meta"><span class="ed-date" id="navi-date"></span></div></div>
      <div class="ed-wrap"><textarea class="ed-body" id="navi-body" placeholder="오늘은 어떤 하루였나요..."></textarea></div>
      <div class="ed-foot"><span id="navi-chars">0자</span><span id="navi-words">0단어</span><span id="navi-pages">0매</span><span style="flex:1"></span><span id="navi-save">저장됨</span></div>
    </div>
    <div class="sub-list" data-g="navi" style="display:none"><div class="list-view" id="navi-list"></div></div>
  </div>

  <!-- 500자 습작 -->
  <div class="view-pane" id="pane-fiction">
    <div class="view-toggle">
      <button class="vt-btn on" onclick="setSubView('fiction','edit')">에디터</button>
      <button class="vt-btn" onclick="setSubView('fiction','list')">목록</button>
      <div class="vt-sp"></div>
      <button class="new-btn" onclick="newDoc('fiction')">+ 새 글</button>
    </div>
    <div class="sub-edit" data-g="fiction">
      <div class="ed-hdr"><input class="ed-title" id="fiction-title" placeholder="제목"><div class="ed-meta"><span class="ed-date" id="fiction-date"></span></div></div>
      <div class="ed-wrap"><textarea class="ed-body" id="fiction-body" placeholder="오늘의 습작을 시작하세요..."></textarea></div>
      <div class="ed-foot"><span id="fiction-chars">0자</span><span id="fiction-words">0단어</span><span id="fiction-pages">0매</span><span style="flex:1"></span><span id="fiction-save">저장됨</span></div>
    </div>
    <div class="sub-list" data-g="fiction" style="display:none"><div class="list-view" id="fiction-list"></div></div>
  </div>

  <!-- 블로그 -->
  <div class="view-pane" id="pane-blog">
    <div class="view-toggle">
      <button class="vt-btn on" onclick="setSubView('blog','edit')">에디터</button>
      <button class="vt-btn" onclick="setSubView('blog','list')">목록</button>
      <div class="vt-sp"></div>
      <button class="new-btn" onclick="newDoc('blog')">+ 새 글</button>
    </div>
    <div class="sub-edit" data-g="blog">
      <div class="ed-hdr"><input class="ed-title" id="blog-title" placeholder="제목"><div class="ed-meta"><span class="ed-date" id="blog-date"></span></div></div>
      <div class="ed-wrap"><textarea class="ed-body" id="blog-body" placeholder="블로그 초고를 써보세요..."></textarea></div>
      <div class="ed-foot"><span id="blog-chars">0자</span><span id="blog-words">0단어</span><span id="blog-pages">0매</span><span style="flex:1"></span><span id="blog-save">저장됨</span></div>
    </div>
    <div class="sub-list" data-g="blog" style="display:none"><div class="list-view" id="blog-list"></div></div>
  </div>

  <!-- 서재 -->
  <div class="view-pane" id="pane-book">
    <div class="view-toggle">
      <button class="vt-btn" onclick="setSubView('book','edit')">입력</button>
      <button class="vt-btn on" onclick="setSubView('book','list')">목록</button>
      <div class="vt-sp"></div>
      <button class="new-btn" onclick="newBook()">+ 새 책</button>
    </div>
    <div class="sub-edit" data-g="book" style="display:none">
      <div class="book-form">
        <div class="bf-field">
          <span class="bf-label">제목</span>
          <input class="bf-input" id="book-title" placeholder="책 제목을 입력하세요">
        </div>
        <div class="bf-row">
          <div class="bf-field" style="flex:2">
            <span class="bf-label">저자</span>
            <input class="bf-input" id="book-author" placeholder="저자명">
          </div>
          <div class="bf-field" style="flex:2">
            <span class="bf-label">출판사</span>
            <input class="bf-input" id="book-publisher" placeholder="출판사명">
          </div>
          <div class="bf-field" style="flex:1">
            <span class="bf-label">읽은 양</span>
            <input class="bf-input" id="book-pages" placeholder="페이지" type="number">
          </div>
        </div>
      </div>
      <div class="ed-wrap"><textarea class="ed-body" id="book-body" placeholder="책에 대한 메모를 남겨보세요..."></textarea></div>
      <div style="padding:10px 36px;border-top:1px solid var(--border);display:flex;justify-content:flex-end;background:var(--bg)">
        <button class="save-btn" onclick="saveBook()">저장</button>
      </div>
    </div>
    <div class="sub-list" data-g="book"><div class="list-view" id="book-list"></div></div>
  </div>

  <!-- 어구록 -->
  <div class="view-pane" id="pane-quote">
    <div class="view-toggle">
      <button class="vt-btn on" onclick="setSubView('quote','edit')">입력</button>
      <button class="vt-btn" onclick="setSubView('quote','list')">목록</button>
    </div>
    <div class="sub-edit" data-g="quote">
      <div class="by-row" style="margin-top:12px;margin-bottom:12px">
        <input class="by-input" id="quote-by" placeholder="출처 (책 제목, 저자 등)">
      </div>
      <div class="ed-wrap"><textarea class="ed-body" id="quote-body" placeholder="인상 깊은 문장을 기록하세요..." style="font-size:14px;line-height:1.9"></textarea></div>
      <div style="padding:10px 36px;border-top:1px solid var(--border);display:flex;justify-content:flex-end;background:var(--bg)">
        <button class="save-btn" onclick="saveQuote()">저장</button>
      </div>
    </div>
    <div class="sub-list" data-g="quote" style="display:none"><div class="list-view" id="quote-list"></div></div>
  </div>

  <!-- 메모 -->
  <div class="view-pane" id="pane-memo">
    <div class="view-toggle">
      <button class="vt-btn on" onclick="setSubView('memo','edit')">입력</button>
      <button class="vt-btn" onclick="setSubView('memo','list')">목록</button>
      <div class="vt-sp"></div>
      <button class="new-btn" onclick="newMemo()">+ 새 메모</button>
    </div>
    <div class="sub-edit" data-g="memo">
      <div class="ed-hdr"><input class="ed-title" id="memo-title" placeholder="메모 제목"><div class="ed-meta"><span class="ed-date" id="memo-date"></span></div></div>
      <div class="ed-wrap"><textarea class="ed-body" id="memo-body" placeholder="메모를 작성하세요..."></textarea></div>
      <div style="padding:10px 36px;border-top:1px solid var(--border);display:flex;justify-content:flex-end;background:var(--bg)">
        <button class="save-btn" onclick="saveMemo()">완료</button>
      </div>
    </div>
    <div class="sub-list" data-g="memo" style="display:none"><div class="list-view" id="memo-list"></div></div>
  </div>
</div>
</div>

<script>
const K={docs:'gb_docs',checks:'gb_chk',books:'gb_books',quotes:'gb_quotes',memos:'gb_memos'};
const L=k=>{try{return JSON.parse(localStorage.getItem(k))||null}catch{return null}};
const S=(k,v)=>localStorage.setItem(k,JSON.stringify(v));

const today=()=>new Date().toISOString().slice(0,10);
const weekdays=['일','월','화','수','목','금','토'];
const fmtDate=iso=>{const d=new Date(iso);return`${d.getFullYear()}.${String(d.getMonth()+1).padStart(2,'0')}.${String(d.getDate()).padStart(2,'0')} (${weekdays[d.getDay()]})`};

function getWeekDates(){
  const d=new Date();const day=d.getDay();
  // 일요일 시작: 일(0)~토(6)
  const sun=new Date(d);sun.setDate(d.getDate()-day);
  return Array.from({length:7},(_,i)=>{const x=new Date(sun);x.setDate(sun.getDate()+i);return x.toISOString().slice(0,10)});
}
const isThisWeek=iso=>getWeekDates().includes(iso?.slice(0,10));

document.getElementById('sideDate').textContent=fmtDate(new Date().toISOString());

// ═══ Daily Checks ═══
const CHECKS=[
  {id:'exercise',label:'운동'},
  {id:'vitamin',label:'영양제'},
  {id:'english',label:'영어'},
  {id:'japanese',label:'일본어'},
  {id:'drawing',label:'드로잉'},
  {id:'ukulele',label:'우쿨렐레'},
  {id:'nodrink',label:'금주'},
];

function getChk(){const d=L(K.checks)||{};return d[today()]||{}}
function saveChk(id,v){const d=L(K.checks)||{};if(!d[today()])d[today()]={};d[today()][id]=v;S(K.checks,d)}
function getAllChk(){return L(K.checks)||{}}

function renderChk(){
  const chk=getChk();
  const allChk=getAllChk();
  const week=getWeekDates();
  const todayS=today();
  const dayLabels=['일','월','화','수','목','금','토'];

  let html=`<div class="chk-week-hdr"><div class="chk-lb-space"></div><div class="day-labels">`;
  dayLabels.forEach(d=>{html+=`<div class="day-lbl">${d}</div>`});
  html+=`</div></div>`;

  CHECKS.forEach(c=>{
    const checked=chk[c.id];
    html+=`<div class="chk-row ${checked?'on':''}" onclick="toggleChk('${c.id}')">
      <div class="chk-box"><svg viewBox="0 0 16 16"><polyline points="3,8 7,12 13,4"/></svg></div>
      <span class="chk-lb">${c.label}</span>
      <div class="chk-dots">`;
    week.forEach(dt=>{
      const done=allChk[dt]&&allChk[dt][c.id];
      html+=`<div class="chk-dot ${done?'done':''} ${dt===todayS?'today':''}"></div>`;
    });
    html+=`</div></div>`;
  });

  document.getElementById('chkTable').innerHTML=html;
}

function toggleChk(id){const chk=getChk();saveChk(id,!chk[id]);renderChk()}

// ═══ Documents ═══
function allDocs(){return L(K.docs)||[]}
function getDocs(type){return allDocs().filter(d=>d.type===type)}
function saveDocs(docs){S(K.docs,docs)}
const curIds={};

function newDoc(type){
  const doc={id:Date.now().toString(),type,title:'',content:'',created:new Date().toISOString(),updated:new Date().toISOString()};
  const docs=allDocs();docs.unshift(doc);saveDocs(docs);
  loadDoc(type,doc.id);setSubView(type,'edit');
}

function loadDoc(type,id){
  const doc=allDocs().find(d=>d.id===id);if(!doc)return;
  curIds[type]=id;
  document.getElementById(`${type}-title`).value=doc.title;
  document.getElementById(`${type}-body`).value=doc.content;
  document.getElementById(`${type}-date`).textContent=fmtDate(doc.created);
  updateWC(type);setSubView(type,'edit');
}

function saveCurDoc(type){
  if(!curIds[type])return;
  const docs=allDocs();const idx=docs.findIndex(d=>d.id===curIds[type]);if(idx===-1)return;
  docs[idx].title=document.getElementById(`${type}-title`).value;
  docs[idx].content=document.getElementById(`${type}-body`).value;
  docs[idx].updated=new Date().toISOString();
  saveDocs(docs);
  const el=document.getElementById(`${type}-save`);if(el)el.textContent='저장됨';
  updateWritingStats();
}

function delDoc(type,id,e){
  e.stopPropagation();if(!confirm('삭제할까요?'))return;
  let docs=allDocs().filter(d=>d.id!==id);saveDocs(docs);
  if(curIds[type]===id){const rem=docs.filter(d=>d.type===type);if(rem.length)loadDoc(type,rem[0].id);else newDoc(type);}
  renderList(type);updateWritingStats();
}

function countS(t){const c=t.replace(/\s/g,'').length;const w=t.trim()?t.trim().split(/\s+/).length:0;return{c,w,p:Math.ceil(c/200)}}
function updateWC(type){
  const t=document.getElementById(`${type}-body`).value;const{c,w,p}=countS(t);
  const ce=document.getElementById(`${type}-chars`),we=document.getElementById(`${type}-words`),pe=document.getElementById(`${type}-pages`);
  if(ce){ce.textContent=c.toLocaleString()+'자';we.textContent=w.toLocaleString()+'단어';pe.textContent=p+'매'}
}

function renderList(type){
  const docs=getDocs(type);
  const colors={navi:'var(--tab-navi)',fiction:'var(--tab-500)',blog:'var(--tab-blog)'};
  const el=document.getElementById(`${type}-list`);if(!el)return;
  if(!docs.length){el.innerHTML='<div style="text-align:center;padding:50px;color:var(--tx-m)">아직 글이 없습니다</div>';return}
  el.innerHTML=docs.map(d=>{
    const{c}=countS(d.content);const prev=d.content.replace(/\n/g,' ').slice(0,80);
    return`<div class="list-item" onclick="loadDoc('${type}','${d.id}')">
      <div class="list-tag" style="background:${colors[type]}"></div>
      <div class="list-info"><div class="list-title">${d.title||'제목 없음'}</div><div class="list-date">${fmtDate(d.created)}</div>${prev?`<div class="list-preview">${prev}</div>`:''}</div>
      <span class="list-extra">${c.toLocaleString()}자</span>
      <button class="list-del" onclick="delDoc('${type}','${d.id}',event)">✕</button></div>`}).join('');
}

// ═══ Books ═══
let curBookId=null;
function getBooks(){return L(K.books)||[]}
function saveBooks(b){S(K.books,b)}

function newBook(){
  curBookId=null;
  ['book-title','book-author','book-publisher','book-pages','book-body'].forEach(id=>document.getElementById(id).value='');
  setSubView('book','edit');
}

function saveBook(){
  const title=document.getElementById('book-title').value.trim();
  if(!title){alert('책 제목을 입력해주세요');return}
  const books=getBooks();
  const data={title,author:document.getElementById('book-author').value.trim(),publisher:document.getElementById('book-publisher').value.trim(),pages:parseInt(document.getElementById('book-pages').value)||0,memo:document.getElementById('book-body').value,date:today(),updated:new Date().toISOString()};
  if(curBookId){const idx=books.findIndex(b=>b.id===curBookId);if(idx!==-1)Object.assign(books[idx],data)}
  else{data.id=Date.now().toString();data.created=new Date().toISOString();books.unshift(data);curBookId=data.id}
  saveBooks(books);renderBookList();renderBookMini();setSubView('book','list');
}

function loadBook(id){
  const b=getBooks().find(x=>x.id===id);if(!b)return;curBookId=id;
  document.getElementById('book-title').value=b.title;
  document.getElementById('book-author').value=b.author||'';
  document.getElementById('book-publisher').value=b.publisher||'';
  document.getElementById('book-pages').value=b.pages||'';
  document.getElementById('book-body').value=b.memo||'';
  setSubView('book','edit');
}

function delBook(id,e){
  e.stopPropagation();if(!confirm('삭제할까요?'))return;
  saveBooks(getBooks().filter(b=>b.id!==id));renderBookList();renderBookMini();
}

function renderBookList(){
  const books=getBooks();const el=document.getElementById('book-list');
  if(!books.length){el.innerHTML='<div style="text-align:center;padding:50px;color:var(--tx-m)">등록된 책이 없습니다</div>';return}
  el.innerHTML=books.map(b=>`
    <div class="list-item" onclick="loadBook('${b.id}')">
      <div class="list-tag" style="background:var(--tab-book)"></div>
      <div class="list-info"><div class="list-title">${b.title}</div><div class="list-date">${b.author||''}${b.publisher?' · '+b.publisher:''}</div>${b.memo?`<div class="list-preview">${b.memo.replace(/\n/g,' ').slice(0,60)}</div>`:''}</div>
      <span class="list-extra">${b.pages?b.pages+'p':''}</span>
      <button class="list-del" onclick="delBook('${b.id}',event)">✕</button></div>`).join('');
}

function renderBookMini(){
  const books=getBooks().filter(b=>b.date&&(b.date===today()||isThisWeek(b.date))).slice(0,3);
  const el=document.getElementById('bookMiniList');
  if(!books.length){el.innerHTML='<div style="font-size:11px;color:var(--tx-m)">이번 주 기록 없음</div>';return}
  el.innerHTML=books.map(b=>`<div class="book-mini"><span class="book-mini-t">${b.title}</span><span class="book-mini-p">${b.pages?b.pages+'p':''}</span></div>`).join('');
}

// ═══ Quotes ═══
function getQuotes(){return L(K.quotes)||[]}
function saveQuotes(q){S(K.quotes,q)}

function saveQuote(){
  const text=document.getElementById('quote-body').value.trim();if(!text)return;
  const by=document.getElementById('quote-by').value.trim();
  const quotes=getQuotes();quotes.unshift({id:Date.now().toString(),text,by,created:new Date().toISOString()});
  saveQuotes(quotes);
  document.getElementById('quote-body').value='';document.getElementById('quote-by').value='';
  renderQuoteList();showRandomQuote();
}

function delQuote(id,e){
  e.stopPropagation();if(!confirm('삭제할까요?'))return;
  saveQuotes(getQuotes().filter(q=>q.id!==id));renderQuoteList();showRandomQuote();
}

function renderQuoteList(){
  const quotes=getQuotes();const el=document.getElementById('quote-list');
  if(!quotes.length){el.innerHTML='<div style="text-align:center;padding:50px;color:var(--tx-m)">어구록이 비어있습니다</div>';return}
  el.innerHTML=quotes.map(q=>`
    <div class="list-item" style="align-items:flex-start">
      <div class="list-tag" style="background:var(--tab-quote);min-height:20px"></div>
      <div class="list-info"><div class="list-preview" style="white-space:normal;font-size:13px;color:var(--tx);font-family:'Noto Serif KR',serif;line-height:1.7">${q.text.slice(0,120)}${q.text.length>120?'...':''}</div>${q.by?`<div class="list-date" style="margin-top:4px">${q.by}</div>`:''}</div>
      <button class="list-del" onclick="delQuote('${q.id}',event)">✕</button></div>`).join('');
}

function showRandomQuote(){
  const quotes=getQuotes();
  if(!quotes.length){document.getElementById('rqText').textContent='어구록에 문장을 추가해보세요';document.getElementById('rqText').style.color='var(--tx-m)';document.getElementById('rqText').style.fontSize='12px';document.getElementById('rqBy').textContent='';return}
  const q=quotes[Math.floor(Math.random()*quotes.length)];
  document.getElementById('rqText').textContent=q.text.length>100?q.text.slice(0,100)+'…':q.text;
  document.getElementById('rqText').style.color='var(--tx)';document.getElementById('rqText').style.fontSize='13px';
  document.getElementById('rqBy').textContent=q.by?'— '+q.by:'';
}

// ═══ Writing Stats ═══
function updateWritingStats(){
  const docs=allDocs().filter(d=>d.type==='fiction');
  const todayS=today();const weekDates=getWeekDates();
  let tToday=0,tWeek=0,tTotal=0;
  docs.forEach(d=>{
    const chars=d.content.replace(/\s/g,'').length;const dt=d.created?.slice(0,10);
    tTotal+=chars;if(dt===todayS)tToday+=chars;if(weekDates.includes(dt))tWeek+=chars;
  });
  document.getElementById('wToday').textContent=Math.ceil(tToday/200);
  document.getElementById('wWeek').textContent=Math.ceil(tWeek/200);
  document.getElementById('wTotal').textContent=Math.ceil(tTotal/200);
  document.getElementById('wBar').style.width=Math.min(100,Math.ceil(tToday/200)/10*100)+'%';
}

// ═══ Tab & View ═══
function switchTab(t){
  document.querySelectorAll('.tab').forEach(el=>el.classList.remove('on'));
  document.querySelector(`.tab[data-t="${t}"]`).classList.add('on');
  document.querySelectorAll('.view-pane').forEach(el=>el.classList.remove('on'));
  document.getElementById(`pane-${t}`).classList.add('on');
  if(['navi','fiction','blog'].includes(t))renderList(t);
  if(t==='book')renderBookList();if(t==='quote')renderQuoteList();if(t==='memo')renderMemoList();
}

function setSubView(group,mode){
  const pane=document.getElementById(`pane-${group}`);
  pane.querySelectorAll('.sub-edit,.sub-list').forEach(el=>el.style.display='none');
  const target=pane.querySelector(`.sub-${mode==='edit'?'edit':'list'}[data-g="${group}"]`);
  if(mode==='edit'){target.style.display='flex';target.style.flexDirection='column';target.style.flex='1';target.style.overflow='hidden'}
  else{target.style.display='block'}
  pane.querySelectorAll('.vt-btn').forEach(b=>b.classList.remove('on'));
  pane.querySelectorAll('.vt-btn').forEach(b=>{if((mode==='edit'&&(b.textContent==='에디터'||b.textContent==='입력'))||(mode==='list'&&b.textContent==='목록'))b.classList.add('on')});
  if(mode==='list'){if(['navi','fiction','blog'].includes(group))renderList(group);if(group==='book')renderBookList();if(group==='quote')renderQuoteList();if(group==='memo')renderMemoList()}
}

// ═══ Memos ═══
let curMemoId=null;
function getMemos(){return L(K.memos)||[]}
function saveMemos(m){S(K.memos,m)}

function newMemo(){
  curMemoId=null;
  document.getElementById('memo-title').value='';
  document.getElementById('memo-body').value='';
  document.getElementById('memo-date').textContent=fmtDate(new Date().toISOString());
  setSubView('memo','edit');
}

function saveMemo(){
  const title=document.getElementById('memo-title').value.trim();
  const body=document.getElementById('memo-body').value.trim();
  if(!title&&!body)return;
  const memos=getMemos();
  if(curMemoId){
    const idx=memos.findIndex(m=>m.id===curMemoId);
    if(idx!==-1){memos[idx].title=title;memos[idx].content=body;memos[idx].updated=new Date().toISOString()}
  }else{
    const memo={id:Date.now().toString(),title,content:body,created:new Date().toISOString(),updated:new Date().toISOString()};
    memos.unshift(memo);curMemoId=memo.id;
  }
  saveMemos(memos);renderMemoList();setSubView('memo','list');
}

function loadMemo(id){
  const m=getMemos().find(x=>x.id===id);if(!m)return;curMemoId=id;
  document.getElementById('memo-title').value=m.title||'';
  document.getElementById('memo-body').value=m.content||'';
  document.getElementById('memo-date').textContent=fmtDate(m.created);
  setSubView('memo','edit');
}

function delMemo(id,e){
  e.stopPropagation();if(!confirm('삭제할까요?'))return;
  saveMemos(getMemos().filter(m=>m.id!==id));renderMemoList();
}

function renderMemoList(){
  const memos=getMemos();const el=document.getElementById('memo-list');
  if(!memos.length){el.innerHTML='<div style="text-align:center;padding:50px;color:var(--tx-m)">메모가 없습니다</div>';return}
  el.innerHTML=memos.map(m=>`
    <div class="list-item" onclick="loadMemo('${m.id}')">
      <div class="list-tag" style="background:#7a8a7a"></div>
      <div class="list-info"><div class="list-title">${m.title||'제목 없음'}</div><div class="list-date">${fmtDate(m.created)}</div>${m.content?`<div class="list-preview">${m.content.replace(/\n/g,' ').slice(0,60)}</div>`:''}</div>
      <button class="list-del" onclick="delMemo('${m.id}',event)">✕</button></div>`).join('');
}

// ═══ Auto-save ═══
const timers={};
function setupEditor(type){
  const body=document.getElementById(`${type}-body`);const title=document.getElementById(`${type}-title`);if(!body)return;
  const onInput=()=>{const sv=document.getElementById(`${type}-save`);if(sv)sv.textContent='저장 중...';clearTimeout(timers[type]);timers[type]=setTimeout(()=>saveCurDoc(type),800);updateWC(type)};
  body.addEventListener('input',onInput);if(title)title.addEventListener('input',onInput);
}

// ═══ Init ═══
function init(){
  renderChk();renderBookMini();showRandomQuote();updateWritingStats();
  ['navi','fiction','blog'].forEach(type=>{
    setupEditor(type);const docs=getDocs(type);
    if(docs.length)loadDoc(type,docs[0].id);else newDoc(type);
  });
  document.addEventListener('keydown',e=>{if((e.ctrlKey||e.metaKey)&&e.key==='s'){e.preventDefault();['navi','fiction','blog'].forEach(t=>saveCurDoc(t))}});
}
init();
</script>
</body>
</html>
